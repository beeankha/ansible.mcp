---
- name: Run ansible.mcp.tools_info tests
  hosts: mcp_servers
  gather_facts: false

  tasks:
    - name: List tools from MCP servers
      ansible.mcp.tools_info:
      register: result

    - name: Validate that the module response is as expected
      ansible.builtin.assert:
        that:
          - '"tools" in result'
          - result.tools | length > 0
          - result.tools | selectattr('name', 'equalto', 'pull_request_read') | list | length == 1
