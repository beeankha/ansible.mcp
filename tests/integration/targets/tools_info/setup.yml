---
- hosts: localhost
  gather_facts: true

  vars:
    ansible_mcp_hosts:
      - name: github
        server_name: github
        bearer_token: "{{ github_mcp_pat }}"
        manifest_path: "{{ playbook_dir }}/manifest.json"

  tasks:
    - ansible.builtin.import_role:
        name: generate_inventory

    - name: Copy temporary inventory file into expected location
      ansible.builtin.copy:
        src: "{{ generate_inventory_file_path }}"
        dest: "{{ playbook_dir }}/inventory.yml"

    - name: Delete path to the inventory
      ansible.builtin.file:
        state: absent
        path: "{{ generate_inventory_file_path }}"
